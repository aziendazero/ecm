<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
	</head>
	<body th:fragment="footer">

		<!-- loading image div -->
		<div id="loadingImg"></div>

		<!-- link back to top -->
		<a href="#0" class="cd-top"></a>

		<!-- Bootstrap -->
		<script src="../static/gentella/js/bootstrap.min.js"
				th:src="@{/gentella/js/bootstrap.min.js}"></script>
		<!-- pace page loader -->
		<script src="../static/gentella/js/pace/pace.min.js"
				th:src="@{/gentella/js/pace/pace.min.js}"></script>
		<!-- Validator -->
		<script src="../static/gentella/js/validator/validator.js"
				th:src="@{/gentella/js/validator/validator.js}"></script>
		<!-- form wizard -->
		<script src="../static/gentella/js/wizard/jquery.smartWizard.js"
				th:src="@{/gentella/js/wizard/jquery.smartWizard.js}"></script>

		<!-- DataTable -->
		<script src="../static/gentella/js/datatables/jquery.dataTables.min.js"
				th:src="@{/gentella/js/datatables/jquery.dataTables.min.js}"></script>
		<script src="../static/gentella/js/datatables/dataTables.bootstrap.js"
				th:src="@{/gentella/js/datatables/dataTables.bootstrap.js}"></script>
		<script src="../static/gentella/js/datatables/dataTables.buttons.min.js"
				th:src="@{/gentella/js/datatables/dataTables.buttons.min.js}"></script>
		<script src="../static/gentella/js/datatables/buttons.bootstrap.min.js"
				th:src="@{/gentella/js/datatables/buttons.bootstrap.min.js}"></script>

		<!--  DataTable responsive -->
		<script src="../static/gentella/js/datatables/dataTables.responsive.min.js"
				th:src="@{/gentella/js/datatables/dataTables.responsive.min.js}"></script>

		<!-- iCheck -->
		<script src="../static/gentella/js/icheck/icheck.min.js"
				th:src="@{/gentella/js/icheck/icheck.min.js}"></script>

		<!-- Switch dei form -->
		<script src="../static/gentella/js/switchery/switchery.min.js"
				th:src="@{/gentella/js/switchery/switchery.min.js}"></script>

		<!-- Custom -->
		<script src="../static/gentella/js/custom.js"
				th:src="@{/gentella/js/custom.js}"></script>

		<!-- PNotify -->
		<script src="../static/gentella/js/notify/pnotify.core.js"
				th:src="@{/gentella/js/notify/pnotify.core.js}"></script>
		<script src="../static/gentella/js/notify/pnotify.buttons.js"
				th:src="@{/gentella/js/notify/pnotify.buttons.js}"></script>
		<script src="../static/gentella/js/notify/pnotify.nonblock.js"
				th:src="@{/gentella/js/notify/pnotify.nonblock.js}"></script>

		<!-- ECM js -->
		<script src="../static/js/main.js"
				th:src="@{/js/main.js}"></script>

		<!-- bootstrap-select -->
		<script	src="../static/bootstrapSelect/js/bootstrapSelect.min.js"
			th:src="@{/bootstrapSelect/js/bootstrapSelect.min.js}"></script>

		<script
			src="../static/bootstrapSelect/js/bootstrapSelect.js"
			th:src="@{/bootstrapSelect/js/bootstrapSelect.js}"></script>

		<!-- back to top -->
		<script
			src="../static/backToTop/js/main.js"
			th:src="@{/backToTop/js/main.js}"></script>
		<script
			src="../static/backToTop/js/modernizr.js"
			th:src="@{/backToTop/js/modernizr.js}"></script>

		<!-- spin.js loading spinner -->
		<script
			src="../static/spinJS/spin.js"
			th:src="@{/spinJS/spin.js}"></script>

		<!-- initialize the validator.js  -->
		<script th:inline="javascript">
	        /*<![CDATA[*/
	        validator.message['invalid'] = [[#{error.invalid}]];
	        validator.message['empty'] = [[#{error.empty}]];
	        validator.message['min'] = [[#{error.min}]];
	        validator.message['max'] = [[#{error.max}]];
	        validator.message['number_min'] = [[#{error.number_min}]];
	        validator.message['number_max'] = [[#{error.number_max}]];
	        validator.message['url'] = [[#{error.url}]];
	        validator.message['number'] = [[#{error.number}]];
	        validator.message['email'] = [[#{error.email}]];
	        validator.message['email_repeat'] = [[#{error.email_repeat}]];
	        validator.message['password_repeat'] = [[#{error.password_repeat}]];
	        validator.message['repeat'] = [[#{error.repeat}]];
	        validator.message['complete'] = [[#{error.complete}]];
	        validator.message['select'] = [[#{error.select}]];

	       /* loading image spinner */
			var opts = {
  				lines: 15, // The number of lines to draw
				length: 20, // The length of each line
 				width: 7, // The line thickness
 				radius: 57, // The radius of the inner circle
 				scale: 0.50, // Scales overall size of the spinner
				corners: 1, // Corner roundness (0..1)
 				color: '#1abc9c', // #rgb or #rrggbb or array of colors
 				opacity: 0.15, // Opacity of the lines
 				rotate: 0, // The rotation offset
 				direction: 1, // 1: clockwise, -1: counterclockwise
 				speed: 1, // Rounds per second
 				trail: 55, // Afterglow percentage
 				fps: 20, // Frames per second when using setTimeout() as a fallback for CSS
 				zIndex: 2e9, // The z-index (defaults to 2000000000)
 				className: 'spinner', // The CSS class to assign to the spinner
 				top: '50%', // Top position relative to parent
 				left: '50%', // Left position relative to parent
 				shadow: true, // Whether to render a shadow
 				hwaccel: false, // Whether to use hardware acceleration
 				position: 'absolute', // Element positioning
			}
			var target = document.getElementById('loadingImg');
			var spinner = new Spinner(opts).spin(target);

			/* show/hide loading spinner */
			var $loading = $('#loadingImg').hide();
			$(document)
			.ajaxStart(function () {$loading.show();})
  			.ajaxStop(function () {$loading.hide();});

	        /* validate a field on "blur" event, a 'select' on 'change' event and a '.required' classed multifield on 'keyup':*/
	        $('form')
	            .on('blur', 'input[required], input.optional, select.required, input[required][pattern]', validator.checkField)
	            .on('change', 'select.required', validator.checkField);

	        $('.multi.required')
	            .on('keyup blur', 'input', function () {
	                validator.checkField.apply($(this).siblings().last()[0]);
	            });

	        //TODO decommentare per fare validazione prima di inviare il form
	    /*     $('form').submit(function (e) {
	            e.preventDefault();
	            var submit = true;
	            // evaluate the form using generic validaing
	            if (!validator.checkAll($(this))) {
	                submit = false;
	            }

	            if (submit)
	                this.submit();
	            return false;
	        }); */

	        $('#alerts').change(function() {
	            validator.defaults.alerts = (this.checked) ? false : true;
	            if (this.checked)
	              $('form .alert').remove();
	        }).prop('checked', false);

	        $('.datatable-responsive-validate').DataTable({
				"bFilter" : false,
				"bInfo" : false,
				"bPaginate" : false,
				"ordering" : false,
				"columnDefs": [ {
					"targets": 4,
					"width": "1px",
					"sClass": "center"
				} ],
			});

			$('.datatable-responsive').DataTable({
				"bFilter" : false,
				"bInfo" : false,
				"bPaginate" : false,
				"ordering" : false,
			});

			$('.datatable-responsive-ordering').DataTable({
				"bFilter" : false,
			});

			$('.datatable-responsive-search').DataTable({
				"bInfo" : false,
				"bPaginate" : false,
				scrollY: 300,
				"bScrollCollapse": true,
			    scroller: true,
				//colonna del pulsante seleziona
			    "order": [[ 0, 'asc' ], [ 1, 'asc' ]],
			    "columnDefs": [
			                   	{"targets": [ '_all' ], "orderable": false },
			                    {"targets": 3, "orderable": false, "width": "1px"},
			                    {"targets": [ 0 ], "orderData": [ 0, 1 ] }
			                  ],
			    "order": [[ 0, 'asc' ], [ 1, 'asc' ]],
			});

			$('.datatable-responsive-search-anagrafica').DataTable({
				"bInfo" : false,
				"bPaginate" : false,
			    "order": [[ 0, 'asc' ], [ 1, 'asc' ]],
			});

			$('.datatable-responsive-mypay').DataTable({
				"bFilter" : false,
				"bInfo" : false,
				"bPaginate" : false,
				"ordering" : false,
				"columnDefs": [ {
					"targets": 4,
					"width": "1px",
					"sClass": "center"
				} ]
			});

			$('.datatable-responsive-eventi').DataTable({
				"bFilter" : false,
				"bInfo" : false,
				"bPaginate" : false,
				"ordering" : false,
				"columnDefs": [ {
					"targets": 4,
					"width": "1px",
					"sClass": "center"
				} ]
			});

			//init datatable visualizzazione di tutte le valutazioni dell'accreditamento
			$(".modal-altreValutazioni").one('shown.bs.modal', function() {
				$('.datatable-responsive-search-validation').DataTable({
					"bInfo" : false,
					"bPaginate" : false,
				    "order": [ 0, 'asc' ],
				    "columnDefs": [
				                   	{"targets": [ '_all' ], "orderable": false, "sClass": "center"},
				                    {"targets": [ 0 ], "width": "1px"}
				                  ]
				});
			})

			$('.modal').on('shown.bs.modal', function () {
				$($.fn.dataTable.tables(true)).DataTable()
	           		.responsive.recalc()
	           		.columns.adjust();
		    });

			$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
				$($.fn.dataTable.tables(true)).DataTable()
		           	.responsive.recalc()
		           	.columns.adjust();
		    });

			$('.accordion').on('shown.bs.collapse', function () {
				$($.fn.dataTable.tables(true)).DataTable()
		           	.responsive.recalc()
		           	.columns.adjust();
			});

			var stack_topright = {"dir1": "down", "dir2": "left", "push": "top", "firstpos1": 25, "firstpos2": 25};

			if([[${message}]]){
	        	sendNotify();
		      }

			function sendNotify(){
				var notify = new PNotify({
					title: [[${message} == null ? '' : #{${message?.titolo}}]],
					text:  [[${message} == null ? '' : #{__${message?.testo}__}]],
					type: [[${message?.tipo}]],
					hide: false,
					addclass: "stack-topright",
					stack: stack_topright,
                    buttons: {
                    	sticker: false,
                    },
					mobile: {
					    swipe_dismiss: true,
				    	styling: true ,
					}
            	});
			};

			function sendNotifyStatic(titolo, testo, tipo){
				var notify = new PNotify({
					title: titolo,
					text:  testo,
					type: tipo,
					hide: false,
					addclass: "stack-topright",
					stack: stack_topright,
					animation: "fade",
                    buttons: {
                    	sticker: false,
                    },
					mobile: {
					    swipe_dismiss: true,
				    	styling: true,
					}
            	});
			};

			function animate(element){
				element.addClass('tada animated').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
				      $(this).removeClass('tada animated');
				});
			}

			$(document).ready(function(){
				$('body').tooltip({
				    selector: '[data-toggle="tooltip"]'
				});
			});

			//rimuove class bad (errore validazione) dagli input (le select sono gestite su gentella.validator.validator.js unmark)
			$('input[type=radio], input[type=checkbox]').each(function(){
				$(this).on('ifToggled', function() {
					$(this).closest('.bad').removeClass('bad').find('div.alert').fadeOut(150, function() {
						$(this).remove();
					});

				});
			});

			$("input[type=text], input[type=tel], input[type=password], textarea").each(function(){
				$(this).on("focus", function() {
					$(this).closest('.bad').removeClass('bad').find('div.alert').fadeOut(150, function() {
						$(this).remove();
					});
				});
			});

			$('input[type=file]').each(function(){
				$(this).on("change", function() {
					$(this).closest('.bad').removeClass('bad').find('div.alert').fadeOut(150, function() {
						$(this).remove();
					});
				});
			});

			/*]]>*/
		</script>
	</body>
</html>